---
title: "OZNAL - NHL"
output: html_notebook
---

```{r}
#nejake kniznice
library(dplyr)
library(tidyverse)
library(data.table)
```



```{r}
#setwd(dir) 
path <- ('data/game.csv')
game <- read.csv(path)
head(game)
```
```{r}
game <- subset(game, select=-c(venue_link,venue_time_zone_id, venue_time_zone_offset, venue_time_zone_tz))
head(game)
dim(game)
```


```{r}
dim(game[game$season==20192020,])
dim(subset(game, season==20192020 & type=='P'))
```
```{r}
path <- ('data/game_teams_stats.csv')
game_teams_stats <- read.csv(path)
head(game_teams_stats)
```
```{r}
game_teams_stats <- subset(game_teams_stats, select=-c(head_coach, startRinkSide, goals))
head(game_teams_stats)
dim(game_teams_stats)
```

```{r}
path <- ('data/team_info.csv')
team_info <- read.csv(path)
head(team_info)
```
```{r}
team_info <- subset(team_info, select=-c(franchiseId, link))
head(team_info)
dim(team_info)
```
```{r}
team_stats <- left_join(game_teams_stats, team_info, "team_id")
head(team_stats)
dim(team_stats)
```
```{r}
game[game$outcome=='tbc win tbc',]
```
```{r}
game_test <- game[!(game$outcome == 'tbc win OT' | game$outcome == 'tbc win tbc' | game$outcome == 'home win tbc' | game$outcome == 'away win tbc'),]
dim(game_test)
```
```{r}
dim(game_test[game_test$season==20192020,])
dim(subset(game_test, season==20192020 & type=='P'))
```
```{r}
df_h <- team_stats[(team_stats$HoA == 'home'),]
head(df_h)
dim(df_h)
unique(df_h$HoA)
```
```{r}
df <- inner_join(df_a, df_h, "game_id")
head(df)
dim(df)
```
```{r}
df_a <- team_stats[(team_stats$HoA == 'away'),]
head(df_a)
dim(df_a)
unique(df_a$HoA)
```
```{r}
df <- left_join(game, df, "game_id")
head(df)
dim(df)
```

```{r}
marek <- fread("data/game.csv")
marek[outcome %like% "tbc"]
```


```{r}
dim(game)
glimpse(game)
```

```{r}
distinct(game)
```
https://towardsdatascience.com/data-cleaning-with-r-and-the-tidyverse-detecting-missing-values-ea23c519bc62 tu je dajaky source
Je potrebne zistit vsetky unikatne hodnoty v stlpcoch, to nam moze pomoct pri konvertovani kvantitativnych atributov na kvalitativne
```{r}
unique(game$type)
unique(game$home_rink_side_start)
unique(game$outcome)
```
Vidime ze atribut home_rink_side_start by sa dal konvertovat na kvalitativny atribut, treba vsak vyriesit chybajuce hodnoty (median). Atribut home win/away win by sa dal rozdelit na viacero binarnych stlpcov (vyhral home/away 0/1, OT 0/1, atd.).